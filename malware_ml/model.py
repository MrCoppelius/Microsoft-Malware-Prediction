import os
import catboost as cb

from malware_ml.prepare_data import json_to_pool

DEFAULT_MODEL_PATH = 'models/model.cb'


def load_model(model_path=DEFAULT_MODEL_PATH):
    return cb.CatBoostClassifier().load_model(model_path)


def apply_model_to_json(model, json_data):
    return model.predict_proba(json_to_pool(json_data))[0, 1]
